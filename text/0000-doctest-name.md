- Feature Name: doctest-name
- Start Date: 2010-10-07
- RFC PR: [rust-lang/rfcs#0000](https://github.com/rust-lang/rfcs/pull/0000)
- Rust Issue: [rust-lang/rust#0000](https://github.com/rust-lang/rust/issues/0000)

# Summary
[summary]: #summary

Allow giving documentation tests names for identification in teest runner
output by including `name=NAME` in the doctest code block info string.

# Motivation
[motivation]: #motivation

When doctests run, the test runner prints the name of the module that contains
them and the line number that they start on. With many doctests in a file, it
can be confusing to remember what does what.

By providing the ability to add names to doctests, the test runner output will
be easier to understand.

# Guide-level explanation
[guide-level-explanation]: #guide-level-explanation

Doctests are contained inside of fenced markdown codeblocks that start and end
with lines containing three backticks.

The first set of backticks may be followed by an info string. For example, to
tell the rust compiler to ignore the doctest:

````rust

// This doctest won't run.
```ignore
assert_eq!(2 + 2, 4);
```

````

Normally, doctests do not have names, and when run, the test runner will
identify them by their test binary, module name, and line number:

```
   Doc-tests foo

running 1 test
test src/lib.rs - bar (line 37) ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out
```

If you'd like to have the test runner print a more informative name, perhaps
because there are many doctests in a single file, you can put `name=NAME`,
where `NAME` is the name the test should have, in the doctest's info string.
`NAME` should be a valid Rust identifer.


````rust

```name=arithmetic
assert_eq!(2 + 2, 4);
```

````

```
   Doc-tests foo

running 1 test
test src/lib.rs - bar::arithmetic (line 37) ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out
```

# Reference-level explanation
[reference-level-explanation]: #reference-level-explanation

The set of valid words that may appear in code block info strings is extended
to include patterns of the form `name=IDENT`.

This `IDENT` will be the name of the documentation test generated by the code
block.

When the test runner the documentation test, the test will be identified by
this name, in addition to the test binary, module, and line number.

Restrictions:

- `IDENT` must be a valid rust identifier.

- All `IDENT`s used in this fashion in a given module must be unique

- Multiple `name=IDENT` words may not appear in a single code block's info
  string.

Voilating any of the above restrictions results in a compilation error.

# Drawbacks
[drawbacks]: #drawbacks

- Adds complexity to code block parsing.

- Requires parsing multi-word info strings, which are standard markdown, but
  which does increase the complexity of the markdown parser.

# Rationale and alternatives
[rationale-and-alternatives]: #rationale-and-alternatives

This design seems like the simplest design possible, although viable
alternatives may have been overlooked.

The impact of not doing this is minimal. Doctests test output will remain a
little hard to make sense of.

# Prior art
[prior-art]: #prior-art

None.

# Unresolved questions
[unresolved-questions]: #unresolved-questions

None.

# Future possibilities
[future-possibilities]: #future-possibilities

None.
